---
layout:     post
title:      浏览器线程
subtitle:   
date:       2023-2-23
author:     
header-img:
catalog: true
tags:
- 事件循环
- GUI渲染线程
---
# 浏览器线程
## GUI渲染线程
负责徐显然浏览器界面，解析 HTML, CSS, 构建 DOM 树 和 RenderObject树，布局和绘制等。渲染线程和 JS 引擎线程是互斥的，一个执行另一个就会挂起。

## JS线程
JS 引擎线程负责处理 JS 脚本程序。

一个 Tab (renderer进程) 中只有一个 JS 线程在运行 JS 程序，因为JS 线程和渲染线程互斥，所以 JS 线程执行时间过长就会阻塞页面渲染。

## 事件触发线程
事件触发线程归属于浏览器，而不是JS引擎，用来控制事件循环。

当 JS 引擎执行代码块如 setTimeout，或来自浏览器内核的其他线程的 AJAX 异步请求，鼠标点击时，会将对应任务添加到事件线程中。当对应的事件符合触发条件被触发时，该线程会把事件添加到待处理队列的队尾，等待 JS 引擎的处理。

## 定时触发器线程
setInterval与setTimeout所在线程。

浏览器定时计数器并不是由JavaScript引擎计数的,因为JavaScript引擎是单线程的, 如果处于阻塞线程状态就会影响记计时的准确，因此通过单独线程来计时并触发定时（计时完毕后，添加到事件队列中，等待JS引擎空闲后执行）

注意，W3C在HTML标准中规定，规定要求setTimeout中低于4ms的时间间隔算为4ms。

## 异步http请求线程
XMLHttpRequest在连接后是通过浏览器新开一个线程请求。

检测到状态变更时，如果设置有回调函数，异步线程就产生状态变更事件，将这个回调再放入事件队列中。再由JavaScript引擎执行。

## 浏览器渲染进程（浏览器内核）（Renderer进程，内部是多线程的）
浏览器是多进程的，默认每个Tab页面一个进程，互不影响。主要作用为：页面渲染，脚本执行，事件处理等
